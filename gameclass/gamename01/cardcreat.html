<!DOCTYPE html>
<html>

<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <!-- Bootstrap CSS -->

    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/css/bootstrap.min.css" integrity="sha384-GJzZqFGwb1QTTN6wy59ffF1BuGJpLSa9DkKMp0DgiMDm4iYMj70gZWKYbI706tWS" crossorigin="anonymous">

    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.6/umd/popper.min.js" integrity="sha384-wHAiFfRlMFy6i5SRaxvfOCifBUQy1xHdJ/yoi7FRNXMRBu5WHdZYu1hA6ZOblgut" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/js/bootstrap.min.js" integrity="sha384-B0UglyR+jN6CkvvICOB2joaf5I4l3gm9GU6Hc1og6Ls7i6U/mkkaduKaBhlAXv9k" crossorigin="anonymous"></script>
    <!--index.css-->
    <link rel="stylesheet" type="text/css" href="../../css/index.css">
    <link href="https://fonts.googleapis.com/css?family=Noto+Sans+TC&display=swap" rel="stylesheet">


    <script src="https://cdn.bootcss.com/jquery/3.4.1/jquery.min.js"></script>
    <script src="./labelpool.json"></script>


    <script src="https://cdn.tiny.cloud/1/no-api-key/tinymce/5/tinymce.min.js" referrerpolicy="origin"></script>
    <script>
        tinymce.init({
            selector: 'textarea'
        });
    </script>

    <style>
        .tox-notification--warning {
            display: none !important;
        }
        
        .inactive {
            display: none;
        }
        
        .labelpool {
            margin: 0.15rem;
        }
    </style>
</head>

<body>
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
        <div class="d-flex">
            <a class="navbar-brand" href="#"><img class="w-50" src="../../img/white_logo.png"></a>
        </div>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse " id="navbarSupportedContent">
            <ul class="navbar-nav mr-auto">
                <li class="nav-item ">
                    <a class="align-middle  btn btn-outline-secondary btn-lg" href="../../index.html" type="button">首頁</a>
                </li>
                <li class="nav-item">
                    <a class="align-middle  btn btn-outline-secondary btn-lg" href="../../mytags.html" type="button">最愛</a>
                </li>
                <li class="nav-item">
                    <a class="align-middle  btn btn-outline-secondary btn-lg" href="../../gameclass.html" type="button">分類</a>
                </li>
                <li class="nav-item">
                    <a class="align-middle  btn btn-secondary btn-lg" href="./cardcreat.html" type="button">新增攻略</a>
                </li>
                <li>
                    <a class="align-middle  btn btn-outline-info btn-lg" href="./gamename01_index.html" type="button">gamename01</a>
                </li>
            </ul>

            <div class="col-3"></div>
            <form class="nav-item form-inline my-2 my-lg-0">
                <a class="btn btn-outline-light" href="../../login.html" type="button">登入</a>
                <a class="btn btn-outline-light" href="../../login.html" type="button">註冊</a>

            </form>
        </div>
    </nav>


    <div id='zone-1' class="classify container shadow-lg p-3 mb-5 ">
        <div class="jumbotron">
            <label for="title">標題</label>
            <input id="title" class="form-control display-4" type="text" placeholder="">
            <label for="content-1">內文</label>
            <textarea id="content-1"></textarea>
        </div>
    </div>

    <div id='zone-2' class="classify container shadow-lg p-3 mb-5 ">
        <div class="jumbotron">
            <label for="content-2">文字段落</label>
            <form method="post">
                <textarea id="content-2"></textarea>
            </form>
        </div>
        <div class="d-flex flex-row-reverse ">
            <button class=" btn btn-outline-danger btn-lg" type="button" onclick="deleteZone(this)">刪除段落</button>
        </div>
    </div>

    <script>
        function readURL(input) {
            var idx = input.id.substring(6, input.id.length)
            if (input.files && input.files[0]) {
                var reader = new FileReader();

                reader.onload = function(e) {
                    $('#blah' + idx).attr('src', e.target.result);
                    $('#blah' + idx).removeClass('inactive');
                }

                reader.readAsDataURL(input.files[0]);
            }
        }
    </script>

    <div id='zone-3' class="classify container shadow-lg p-3 mb-5 ">
        <div class="jumbotron">
            <label for="content-3">圖文段落</label>
            <div class="row d-flex">
                <div class="col-sm-7">
                    <textarea id="content-3"></textarea>
                </div>
                <div class="col-sm-5 ">
                    <img id="blah-3" class="inactive" width="100%" alt="your image" />
                    <input type='file' style="width: 100%;" id="imgInp-3" class="btn btn-outline-secondary btn-lg" onchange="readURL(this)" />
                </div>
            </div>
        </div>
        <div class="d-flex flex-row-reverse ">
            <button class=" btn btn-outline-danger btn-lg" type="button" onclick="deleteZone(this)">刪除段落</button>
        </div>
    </div>

    <div id="addzonediv">

    </div>

    <style>
        #finishzong button {
            margin: 0.25rem;
        }
    </style>


    <script>
        function removeitem(value) {
            for (var i = 0; i < context_array.length; i++) {
                if (context_array[i] == value) {
                    context_array.splice(i, 1);
                }
            }
        }

        function deleteZone(event) {
            var parent = event.parentNode.parentNode;

            console.log(parent.id)

            tmpidx = parent.id.substring(5, parent.id.length)
            console.log(tmpidx)
            removeitem('content-' + tmpidx)

            console.log(parent)
            $(parent).remove();
        }
    </script>


    <script>
        zoneidx = 4;
        context_array = ['content-1', 'content-2', 'content-3'];


        function addzone(event) {
            var addzone_view = document.querySelector('#addzonediv');

            var thisdivzone = "zone-" + zoneidx;

            var div_outer = document.createElement("div");
            div_outer.setAttribute("id", thisdivzone);
            div_outer.setAttribute("class", "classify container shadow-lg p-3 mb-5 ");
            addzone_view.appendChild(div_outer);

            addzone_view = document.querySelector('#' + thisdivzone);

            var div_jumbotron = document.createElement("div");
            var thisjumbotron = "jumbotron-" + zoneidx;

            div_jumbotron.setAttribute("class", "jumbotron");
            div_jumbotron.setAttribute("id", thisjumbotron);
            addzone_view.appendChild(div_jumbotron);


            var div_delete = document.createElement("div");
            var thisdelete = "delete-" + zoneidx;

            div_delete.setAttribute("class", "d-flex flex-row-reverse");
            div_delete.setAttribute("id", thisdelete);
            addzone_view.appendChild(div_delete);

            addzone_view = document.querySelector('#' + thisjumbotron);

            if (event == 1) {
                var label = document.createElement("label");
                var thiscontent = 'content-' + zoneidx
                label.setAttribute("for", thiscontent);
                label.innerHTML = '文字段落';
                addzone_view.appendChild(label);
                var textarea = document.createElement("textarea");
                textarea.setAttribute('id', thiscontent);
                addzone_view.appendChild(textarea);
            } else if (event == 2) {

                var label = document.createElement("label");
                var thiscontent = 'content-' + zoneidx
                label.setAttribute("for", thiscontent);
                label.innerHTML = '圖文段落';
                addzone_view.appendChild(label);

                var tmpdiv = document.createElement("div");
                var rowdiv = 'rowdiv-' + zoneidx
                tmpdiv.setAttribute("class", 'row d-flex');
                tmpdiv.setAttribute("id", rowdiv);
                addzone_view.appendChild(tmpdiv);

                addzone_view = document.querySelector('#' + rowdiv);

                var tmpdiv = document.createElement("div");
                var textdiv = 'col-text-' + zoneidx
                tmpdiv.setAttribute("class", 'col-sm-7');
                tmpdiv.setAttribute("id", textdiv);
                addzone_view.appendChild(tmpdiv);

                var tmpdiv = document.createElement("div");
                var imgdiv = 'col-img-' + zoneidx
                tmpdiv.setAttribute("class", 'col-sm-5');
                tmpdiv.setAttribute("id", imgdiv);
                addzone_view.appendChild(tmpdiv);

                addzone_view = document.querySelector('#' + textdiv);
                var textarea = document.createElement("textarea");
                textarea.setAttribute('id', thiscontent);
                addzone_view.appendChild(textarea);


                addzone_view = document.querySelector('#' + imgdiv);
                var img = document.createElement("img");
                img.setAttribute('id', 'blah' + zoneidx);
                img.setAttribute('class', 'inactive');
                img.setAttribute('width', '100%');
                addzone_view.appendChild(img);

                var input = document.createElement("input");
                input.setAttribute('type', 'file');
                input.setAttribute('id', 'imgInp' + zoneidx);
                input.setAttribute('class', 'btn btn-outline-secondary btn-lg');
                input.setAttribute('style', 'width: 100%;')
                input.setAttribute('onchange', 'readURL(this)');
                addzone_view.appendChild(input);
            }
            context_array.push(thiscontent)

            addzone_view = document.querySelector('#' + thisdelete);
            var delbtn = document.createElement("button");
            delbtn.setAttribute('class', 'btn btn-outline-danger btn-lg ');
            delbtn.setAttribute('type', 'button');
            delbtn.setAttribute('onclick', 'deleteZone(this)');
            delbtn.innerHTML = '刪除段落';
            addzone_view.appendChild(delbtn);

            zoneidx++;
            tinymce.init({
                selector: 'textarea'
            });
        }

        function finishedit() {
            title = document.querySelector('#title');
            console.log(title.value)
            console.log(context_array)
            var i = 0

            document.querySelector('#demo-title').innerHTML = title.value;
            document.querySelector('#input-data').innerHTML = ''
            for (i = 0; i < context_array.length; i++) {
                var content = $('#' + context_array[i]).val(tinyMCE.editors[i].getContent());
                console.log(content[0].value)
                document.querySelector('#input-data').innerHTML += content[0].value;
                document.querySelector('#input-data').innerHTML += '<br/>-----------------------------------------------------<br/>';
            }

        }
    </script>
    <!-- Modal -->
    <div class="modal fade" id="finishmodal" tabindex="-1" role="dialog" aria-labelledby="finishmodal" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="demo-title">Modal title</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div id='input-data' class="modal-body">
                </div>
                <div class="modal-footer">
                    <span>由於此期末專題未架設後台資料庫，以此視窗驗證取值功能正確。</span>
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>

    <div id="finishzong" class="main-view d-flex flex-row-reverse container shadow-lg p-3 mb-5">
        <button class=" btn btn-info btn-lg" data-toggle="modal" data-target="#finishmodal" type="" onclick="finishedit()">完成編輯</button>
        <button class=" btn btn-outline-secondary btn-lg" type="button" onclick="addzone(1)">新增文字段落</button>
        <button class=" btn btn-outline-secondary btn-lg" type="button" onclick="addzone(2)">新增圖/文段落</button>

    </div>
</body>

</html>